# CloseSocket
#include &lt;MsgBoxConstants.au3>  Local $Port = 19534 Local $Server = '51.15.19.21'  TCPStartup() OnAutoItExitRegister("OnAutoItExit") Global $Socket = TCPConnect($Server, $Port) If $Socket = -1 Then Exit MsgBox(16, 'Error', 'Connection error.') TCPSend($Socket, 'login {"protocol":1,"client":"test","clientver":"0.1"}0x04') ;TCPSend($Socket, 'dbstats0x04')  While 1     $Data = TCPRecv($Socket, 512)     If $Data &lt;> '' Then         MsgBox(0, 'Received:', $Data)         TCPCloseSocket($Socket)     EndIf Sleep(50) WEnd  Func OnAutoItExit()     TCPShutdown() EndFunc
